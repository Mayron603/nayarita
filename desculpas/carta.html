<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Um Pedido de Desculpas</title>
<link href="css/default.css" type="text/css" rel="stylesheet">
<style>
    #start-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-color: #ffe; display: flex; justify-content: center;
        align-items: center; flex-direction: column; z-index: 9999;
        text-align: center; font-family: sans-serif; color: #555;
    }
    #start-button {
        font-weight: 800; background: transparent; border: solid 2px #ff5757;
        border-radius: 5px; color: #ff5757; font-size: 20px;
        padding: 15px 30px; cursor: pointer; transition: all 0.3s; margin-top: 20px;
    }
    #start-button:hover { background-color: #fc9d9d; color: #a10000; }
</style>
</head>
<body>

<audio id="minhaMusica" loop>
  <source src="sua_musica.mp3" type="audio/mpeg">
  Seu navegador n√£o suporta o elemento de √°udio.
</audio>

<div id="start-overlay">
  <h1>Um momento...</h1>
  <p>Para a melhor experi√™ncia, a m√∫sica precisa da sua permiss√£o.</p>
  <button id="start-button">Clique para Iniciar</button>
</div>

<div id="mainDiv" style="display: none;">
	<div id="content">
		<div id="code">
<span class="space"/><span class="comments">* Eu sei que palavras n√£o bastam,</span><br />
<span class="space"/><span class="comments">* ent√£o quis criar algo pra te mostrar</span><br />
<span class="space"/><span class="comments">* o tamanho do meu arrependimento.</span><br />
<span class="space"/><span class="comments">* O que eu fiz foi errado.</span><br />
<span class="space"/><span class="comments">* Voc√™ √© importante demais pra mim.</span><br />
<span class="space"/><span class="comments">* Agora me desbloqueia sua chata.</span><br />
<span class="space"/><span class="comments">* E pare de ser ansiosa viuu üòÖ</span><br />


		</div>
		<div id="loveHeart">
			<canvas id="garden"></canvas>
			<div id="words">
				<div id="messages"></div>
				<div id="loveu">
					<div class="question">Voc√™ aceita minhas desculpas?</div>
					<div class="buttons">
                        <button id="sim">Sim</button>
                        <button id="nao">N√£o</button>
                    </div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="js/garden.js"></script>
<script src="js/functions.js"></script>

<script>
    $(document).ready(function() {
        $('#start-button').on('click', function() {
            $('#minhaMusica')[0].play();
            $('#start-overlay').fadeOut(function() {
                $('#mainDiv').fadeIn(function() {
                    // 1. Prepara o jardim e o canvas
                    setupGarden();
                    // 2. Define as vari√°veis globais de posicionamento
                    window.offsetX = $("#loveHeart").width() / 2;
                    window.offsetY = $("#loveHeart").height() / 2 - 55;
                    // 3. Inicia as anima√ß√µes
                    startHeartAnimation();
                    $("#code").typewriter();
                });
            });
        });

        // **BOT√ÉO "N√ÉO" COM L√ìGICA CORRIGIDA E MAIS ROBUSTA**
        $('#nao').on('mouseenter', function () {
            // Pega as dimens√µes da janela e do bot√£o
            const windowWidth = $(window).width();
            const windowHeight = $(window).height();
            const btnWidth = $(this).outerWidth();
            const btnHeight = $(this).outerHeight();

            // Calcula a posi√ß√£o m√°xima para n√£o sair da tela
            const maxLeft = windowWidth - btnWidth;
            const maxTop = windowHeight - btnHeight;

            // Gera novas coordenadas aleat√≥rias
            const newLeft = Math.floor(Math.random() * maxLeft);
            const newTop = Math.floor(Math.random() * maxTop);

            // Aplica a nova posi√ß√£o. 'mouseenter' √© mais est√°vel que 'mouseover' para este caso.
            $(this).css({
                'position': 'absolute',
                'left': newLeft + 'px',
                'top': newTop + 'px'
            });
        });

        $('#sim').on('click', function() {
            $('#loveu').html('<div class="question">Obrigado por me desculpar!</div>');
        });
    });
</script>

</body>
</html>